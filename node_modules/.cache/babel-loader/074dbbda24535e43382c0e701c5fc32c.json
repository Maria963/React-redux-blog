{"ast":null,"code":"import _regeneratorRuntime from \"/home/cretrix/projects/React-blog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/cretrix/projects/React-blog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport axios from 'axios';\nvar SERVER_URL = \"http://127.0.0.1:8000\";\nvar Auth = axios.create();\nAuth.interceptors.response.use(function (response) {\n  return response;\n}, function (error) {\n  if (error.response.status === 401) {\n    localStorage.removeItem(\"access_token\");\n    props.history.push(\"/login\");\n  }\n});\n\nvar login =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(data) {\n    var LOGIN_ENDPOINT, response, jwt;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            LOGIN_ENDPOINT = \"\".concat(SERVER_URL, \"/api/login\");\n            console.log('ddd');\n            _context.prev = 2;\n            _context.next = 5;\n            return axios.post(LOGIN_ENDPOINT, data);\n\n          case 5:\n            response = _context.sent;\n            console.log(response); //  if(response.status === 200 && response.data.remember_token && response.data.expireAt){\n\n            if (response.status === 200 && response.data.success === true) {\n              jwt = response.data.token; //  let expire_at = response.data.expireAt;\n\n              localStorage.setItem(\"access_token\", jwt);\n            }\n\n            return _context.abrupt(\"return\", response.data.success);\n\n          case 11:\n            _context.prev = 11;\n            _context.t0 = _context[\"catch\"](2);\n            console.log(_context.t0);\n\n          case 14:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[2, 11]]);\n  }));\n\n  return function login(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n/*\nconst register = async (data) => {\n    const SIGNUP_ENDPOINT = `${SERVER_URL}/api/user/register`;\n    try {\n        let response = await axios({\n            method: 'post',\n            responseType: 'json',\n            url: SIGNUP_ENDPOINT,\n            data: data\n          });\n    } catch(e){\n        console.log(e);\n    }\n}*/\n\n/*\nconst logout = (props) => {\n    localStorage.removeItem(\"access_token\");\n    props.history.push('/login');\n   // localStorage.removeItem(\"expire_at\");\n}\n*/\n\n\nvar isAuth = function isAuth() {\n  console.log(localStorage.getItem('access_token'));\n\n  if (localStorage.getItem('access_token') == null) {\n    return false;\n  }\n\n  return true;\n};\n\nexport { login, isAuth, SERVER_URL };","map":{"version":3,"sources":["/home/cretrix/projects/React-blog/src/utils/JWTAuth.js"],"names":["axios","SERVER_URL","Auth","create","interceptors","response","use","error","status","localStorage","removeItem","props","history","push","login","data","LOGIN_ENDPOINT","console","log","post","success","jwt","token","setItem","isAuth","getItem"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,IAAMC,UAAU,GAAG,uBAAnB;AAEA,IAAMC,IAAI,GAAGF,KAAK,CAACG,MAAN,EAAb;AAGAD,IAAI,CAACE,YAAL,CAAkBC,QAAlB,CAA2BC,GAA3B,CACE,UAAAD,QAAQ,EAAI;AACV,SAAOA,QAAP;AACD,CAHH,EAIE,UAAAE,KAAK,EAAI;AACP,MAAIA,KAAK,CAACF,QAAN,CAAeG,MAAf,KAA0B,GAA9B,EAAmC;AACjCC,IAAAA,YAAY,CAACC,UAAb,CAAwB,cAAxB;AACAC,IAAAA,KAAK,CAACC,OAAN,CAAcC,IAAd,CAAmB,QAAnB;AACD;AAEF,CAVH;;AAcA,IAAMC,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,2BAAG,iBAAOC,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACJC,YAAAA,cADI,aACgBf,UADhB;AAEVgB,YAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;AAFU;AAAA;AAAA,mBAIelB,KAAK,CAACmB,IAAN,CAAWH,cAAX,EAA2BD,IAA3B,CAJf;;AAAA;AAIFV,YAAAA,QAJE;AAKLY,YAAAA,OAAO,CAACC,GAAR,CAAYb,QAAZ,EALK,CAMR;;AACE,gBAAGA,QAAQ,CAACG,MAAT,KAAoB,GAApB,IAA2BH,QAAQ,CAACU,IAAT,CAAcK,OAAd,KAAwB,IAAtD,EAA2D;AACnDC,cAAAA,GADmD,GAC7ChB,QAAQ,CAACU,IAAT,CAAcO,KAD+B,EAEzD;;AACAb,cAAAA,YAAY,CAACc,OAAb,CAAqB,cAArB,EAAqCF,GAArC;AAED;;AAZK,6CAaChB,QAAQ,CAACU,IAAT,CAAcK,OAbf;;AAAA;AAAA;AAAA;AAgBNH,YAAAA,OAAO,CAACC,GAAR;;AAhBM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAALJ,KAAK;AAAA;AAAA;AAAA,GAAX;AAoBA;;;;;;;;;;;;;;;AAcA;;;;;;;;;AAQA,IAAMU,MAAM,GAAG,SAATA,MAAS,GAAM;AACjBP,EAAAA,OAAO,CAACC,GAAR,CAAYT,YAAY,CAACgB,OAAb,CAAqB,cAArB,CAAZ;;AACA,MAAIhB,YAAY,CAACgB,OAAb,CAAqB,cAArB,KAAsC,IAA1C,EAAgD;AAC5C,WAAO,KAAP;AACH;;AACF,SAAO,IAAP;AACF,CAND;;AASA,SAASX,KAAT,EAAgBU,MAAhB,EAAwBvB,UAAxB","sourcesContent":["import axios from 'axios';\nconst SERVER_URL = \"http://127.0.0.1:8000\"\n\nconst Auth = axios.create();\n\n\nAuth.interceptors.response.use(\n  response => {\n    return response;\n  },\n  error => {\n    if (error.response.status === 401) {\n      localStorage.removeItem(\"access_token\");\n      props.history.push(\"/login\");\n    }\n   \n  }\n);\n\n\nconst login = async (data) => {\n    const LOGIN_ENDPOINT = `${SERVER_URL}/api/login`;\n    console.log('ddd');\n    try {\n        let response = await axios.post(LOGIN_ENDPOINT, data);\n         console.log(response)\n      //  if(response.status === 200 && response.data.remember_token && response.data.expireAt){\n        if(response.status === 200 && response.data.success===true){\n            let jwt = response.data.token;\n          //  let expire_at = response.data.expireAt;\n          localStorage.setItem(\"access_token\", jwt);\n         \n        } \n        return response.data.success;\n\n    } catch(e){\n        console.log(e);\n    }\n}\n\n/*\nconst register = async (data) => {\n    const SIGNUP_ENDPOINT = `${SERVER_URL}/api/user/register`;\n    try {\n        let response = await axios({\n            method: 'post',\n            responseType: 'json',\n            url: SIGNUP_ENDPOINT,\n            data: data\n          });\n    } catch(e){\n        console.log(e);\n    }\n}*/\n/*\nconst logout = (props) => {\n    localStorage.removeItem(\"access_token\");\n    props.history.push('/login');\n   // localStorage.removeItem(\"expire_at\");\n}\n*/\n\nconst isAuth = () => {\n    console.log(localStorage.getItem('access_token'));\n    if (localStorage.getItem('access_token')==null) {\n        return false;\n    }\n   return true;\n}\n\n\nexport { login, isAuth, SERVER_URL }"]},"metadata":{},"sourceType":"module"}